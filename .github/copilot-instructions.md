# 七星追剧 - Copilot 指令

<!-- 为 Copilot 提供工作区特定的自定义指令 -->

## 项目概述

这是一个基于 Electron 的 Windows 桌面应用程序，名为"七星追剧"，用于播放苹果CMS资源站的影视节目。项目已完成清理优化，保持简洁的项目结构。

## 项目结构

```text
七星追剧/
├── src/                    # 源代码目录
│   ├── renderer/          # 渲染进程
│   │   ├── index.html     # 主窗口界面
│   │   ├── player.html    # 播放器窗口界面
│   │   ├── logo.png       # 界面Logo（162*58）
│   │   ├── css/          # 样式文件
│   │   │   ├── style.css      # 主样式
│   │   │   ├── components.css # 组件样式
│   │   │   └── routes.css     # 路由样式
│   │   └── js/           # JavaScript模块
│   │       ├── api.js         # API服务
│   │       ├── storage.js     # 本地存储
│   │       ├── components.js  # UI组件
│   │       ├── app.js         # 主应用逻辑
│   │       └── player.js      # 播放器逻辑
│   └── preload.js        # 预加载脚本
├── assets/               # 资源文件
│   ├── icon.png         # 应用图标（256*256）
│   └── logo.png         # 应用Logo（162*58）
├── main.js              # Electron主进程
├── package.json         # 项目配置
├── build.bat           # 完整编译工具
├── dev.bat             # 开发启动工具
├── quick-build.bat     # 快速编译工具
└── README.md           # 项目文档
```

## 技术栈

- **Electron 27.x** - 桌面应用框架，已禁用硬件加速解决GPU问题
- **Node.js** - 运行时环境
- **HLS.js** - 视频播放库，支持m3u8格式流媒体
- **Axios** - HTTP请求库，处理API通信
- **LocalStorage** - 本地数据存储，支持配置持久化
- **原生Web技术** - HTML5/CSS3/ES6+ JavaScript

## 功能特性

### 核心播放功能
1. **多站点支持** - 支持多个苹果CMS API站点，兼容JSON/XML格式
2. **视频搜索** - 按关键词和分类搜索影视内容
3. **视频播放** - 支持m3u8格式的在线播放，基于HLS.js引擎
4. **播放历史** - 记录观看历史和播放进度，支持断点续播
5. **自动播放** - 支持自动播放下一集功能
6. **多窗口播放** - 独立播放器窗口，支持全屏模式

### 站点管理功能（v1.1.0新增）
7. **站点配置管理** - 添加/编辑/删除视频站点，支持批量管理
8. **线路屏蔽功能** - 支持屏蔽指定播放线路（逗号分隔多个线路）
9. **线路别名设置** - 自定义线路显示名称，提升用户体验
10. **智能线路过滤** - 自动忽略被屏蔽的播放线路

### 数据管理功能（v1.1.0新增）
11. **配置导出** - 一键导出所有设置和数据为JSON文件
12. **配置导入** - 支持合并/覆盖两种导入模式
13. **数据迁移** - 跨设备快速同步配置和设置
14. **选择性备份** - 可选择导出特定数据类型（站点/别名/历史等）

### 界面体验
15. **响应式设计** - 适配不同屏幕尺寸
16. **深色主题** - 护眼的暗色界面设计
17. **无菜单栏UI** - 简洁现代的界面设计
18. **美化的设置界面** - 优化的UI交互体验

## 开发规范

### 代码风格
- 使用ES6+语法
- 采用模块化设计
- 遵循语义化命名
- 添加适当的注释
- 优先使用const/let而非var

### 文件命名
- HTML文件使用kebab-case
- CSS类名使用kebab-case
- JavaScript变量使用camelCase
- 常量使用UPPER_SNAKE_CASE
- 批处理文件使用kebab-case

### 界面设计
- Logo尺寸：162*58像素，自适应显示
- 图标尺寸：256*256像素（编译要求）
- 深色主题设计
- 响应式布局
- 简洁无菜单栏界面

## 构建和部署

### 开发环境
```bash
npm install     # 安装依赖
npm start      # 启动开发服务器
dev.bat        # Windows批处理启动
```

### 编译发布
```bash
npm run dist        # 标准编译
build.bat          # 完整编译（推荐）
quick-build.bat    # 快速编译
```

### 输出文件
- 编译输出：`dist/win-unpacked/七星追剧.exe`
- 发布方式：打包整个 `win-unpacked` 文件夹

## 技术特点

### Electron配置
- 已禁用硬件加速（解决GPU崩溃）
- 隐藏菜单栏（autoHideMenuBar + setMenuBarVisibility）
- 配置代码签名跳过
- 支持多窗口（主窗口 + 播放器窗口）

### API集成
- 所有API请求通过ApiService类处理
- 支持JSON和XML格式的苹果CMS API
- 实现错误处理和重试机制

### 数据存储
- 使用localStorage存储用户数据
- 播放历史、观看进度、用户设置等数据持久化
- 线路别名和屏蔽线路配置存储
- 支持配置数据的导入导出功能

### 播放器功能
- 基于HLS.js实现m3u8视频播放
- 支持播放进度保存和恢复
- 实现自动播放下一集功能
- 线路过滤和别名显示

### 站点管理（v1.1.0新增）
- 站点CRUD操作（增删改查）
- 线路屏蔽配置（支持逗号分隔多个线路）
- 线路别名管理
- 智能线路过滤逻辑

## 注意事项

1. **GPU兼容性** - 已禁用硬件加速，避免GPU进程崩溃
2. **图标要求** - 编译需要256*256图标，界面Logo为162*58
3. **代码签名** - 已配置跳过签名避免权限问题
4. **界面优化** - 无菜单栏设计，Logo自适应显示
5. **项目清理** - 已删除所有测试文件和多余批处理文件
6. **路径处理** - 注意渲染进程中的资源路径引用
7. **线路屏蔽** - 屏蔽配置使用精确匹配，避免误伤其他线路
8. **数据导入导出** - 支持JSON格式，包含数据验证和错误处理
9. **版本管理** - 当前版本v1.1.0，包含完整的站点管理和数据管理功能

## 版本更新历史

### v1.1.0 (2025-08-03)
- 🆕 新增线路别名功能，支持自定义线路显示名称
- 🆕 新增线路屏蔽功能，可屏蔽指定播放线路
- 🆕 新增配置导入导出功能，支持数据备份和迁移
- 🔧 优化站点管理界面，美化UI交互体验
- 🐛 修复屏蔽线路过滤逻辑，提高播放稳定性
- 📈 完善错误处理和用户反馈机制

## 开发重点

### 当前重点功能
- **站点管理系统** - 完整的CRUD操作和配置管理
- **线路管理** - 别名设置和屏蔽功能
- **数据管理** - 导入导出和数据迁移
- **用户体验** - UI美化和交互优化

### 技术架构重点
- **模块化设计** - 清晰的代码组织和职责分离
- **数据持久化** - LocalStorage + JSON格式配置
- **错误处理** - 完善的异常捕获和用户反馈
- **性能优化** - 避免GPU问题，优化播放体验
